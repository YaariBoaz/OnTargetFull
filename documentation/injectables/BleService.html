<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>onTarget documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">onTarget documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li>Injectables</li>
  <li >BleService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/shared/services/ble.service.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#activateReconnectProcessCount" >activateReconnectProcessCount</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#ble" >ble</a>
                            </li>
                            <li>
                                <a href="#currentTargetId" >currentTargetId</a>
                            </li>
                            <li>
                                <a href="#dataFromDevice" >dataFromDevice</a>
                            </li>
                            <li>
                                <a href="#devices" >devices</a>
                            </li>
                            <li>
                                <a href="#gateways" >gateways</a>
                            </li>
                            <li>
                                <a href="#gatewayTargets" >gatewayTargets</a>
                            </li>
                            <li>
                                <a href="#isConnectedFlag" >isConnectedFlag</a>
                            </li>
                            <li>
                                <a href="#isGateway" >isGateway</a>
                            </li>
                            <li>
                                <a href="#msgNumber" >msgNumber</a>
                            </li>
                            <li>
                                <a href="#notifyDisconnect" >notifyDisconnect</a>
                            </li>
                            <li>
                                <a href="#notifyResetGateway" >notifyResetGateway</a>
                            </li>
                            <li>
                                <a href="#notifyShotArrived" >notifyShotArrived</a>
                            </li>
                            <li>
                                <a href="#notifyTargetConnected" >notifyTargetConnected</a>
                            </li>
                            <li>
                                <a href="#peripheral" >peripheral</a>
                            </li>
                            <li>
                                <a href="#scanFinished" >scanFinished</a>
                            </li>
                            <li>
                                <a href="#subscription" >subscription</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#activatRecconectProcess" >activatRecconectProcess</a>
                            </li>
                            <li>
                                <a href="#connect" >connect</a>
                            </li>
                            <li>
                                <a href="#dissconect" >dissconect</a>
                            </li>
                            <li>
                                <a href="#getDevices" >getDevices</a>
                            </li>
                            <li>
                                <a href="#handleRead" >handleRead</a>
                            </li>
                            <li>
                                <a href="#ionViewDidLoad" >ionViewDidLoad</a>
                            </li>
                            <li>
                                <a href="#ionViewWillLeave" >ionViewWillLeave</a>
                            </li>
                            <li>
                                <a href="#isConnected" >isConnected</a>
                            </li>
                            <li>
                                <a href="#onConnected" >onConnected</a>
                            </li>
                            <li>
                                <a href="#onDeviceDisconnected" >onDeviceDisconnected</a>
                            </li>
                            <li>
                                <a href="#onDeviceDiscovered" >onDeviceDiscovered</a>
                            </li>
                            <li>
                                <a href="#parseGatewayMessage" >parseGatewayMessage</a>
                            </li>
                            <li>
                                <a href="#resetConnection" >resetConnection</a>
                            </li>
                            <li>
                                <a href="#resetGateway" >resetGateway</a>
                            </li>
                            <li>
                                <a href="#resetShots" >resetShots</a>
                            </li>
                            <li>
                                <a href="#scan" >scan</a>
                            </li>
                            <li>
                                <a href="#scanError" >scanError</a>
                            </li>
                            <li>
                                <a href="#str2ab" >str2ab</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(storage: <a href="../injectables/StorageService.html" target="_self">StorageService</a>, ble: BLE, ngZone: <a href="https://angular.io/api/core/NgZone" target="_blank">NgZone</a>, shootingService: <a href="../injectables/ShootingService.html" target="_self">ShootingService</a>, initService: <a href="../injectables/InitService.html" target="_self">InitService</a>, bluetoothSerial: BluetoothSerial, gatewayService: <a href="../injectables/GatewayService.html" target="_self">GatewayService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/shared/services/ble.service.ts:34</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>storage</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/StorageService.html" target="_self" >StorageService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>ble</td>
                                                  
                                                        <td>
                                                                    <code>BLE</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>ngZone</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://angular.io/api/core/NgZone" target="_blank" >NgZone</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>shootingService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ShootingService.html" target="_self" >ShootingService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>initService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/InitService.html" target="_self" >InitService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>bluetoothSerial</td>
                                                  
                                                        <td>
                                                                    <code>BluetoothSerial</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>gatewayService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/GatewayService.html" target="_self" >GatewayService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="activatRecconectProcess"></a>
                    <span class="name">
                        <span ><b>activatRecconectProcess</b></span>
                        <a href="#activatRecconectProcess"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>activatRecconectProcess()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="233"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:233</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="connect"></a>
                    <span class="name">
                        <span ><b>connect</b></span>
                        <a href="#connect"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>connect(deviceId)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="124"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:124</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>deviceId</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="dissconect"></a>
                    <span class="name">
                        <span ><b>dissconect</b></span>
                        <a href="#dissconect"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>dissconect()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="229"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:229</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDevices"></a>
                    <span class="name">
                        <span ><b>getDevices</b></span>
                        <a href="#getDevices"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getDevices()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="119"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:119</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>    <code>{}</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="handleRead"></a>
                    <span class="name">
                        <span ><b>handleRead</b></span>
                        <a href="#handleRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>handleRead(name, id, service, characteristic)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="176"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:176</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>name</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>id</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>service</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>characteristic</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="ionViewDidLoad"></a>
                    <span class="name">
                        <span ><b>ionViewDidLoad</b></span>
                        <a href="#ionViewDidLoad"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>ionViewDidLoad()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="163"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:163</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="ionViewWillLeave"></a>
                    <span class="name">
                        <span ><b>ionViewWillLeave</b></span>
                        <a href="#ionViewWillLeave"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>ionViewWillLeave()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="167"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:167</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isConnected"></a>
                    <span class="name">
                        <span ><b>isConnected</b></span>
                        <a href="#isConnected"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>isConnected()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="225"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:225</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="onConnected"></a>
                    <span class="name">
                        <span ><b>onConnected</b></span>
                        <a href="#onConnected"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>onConnected(peripheral: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="147"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:147</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>peripheral</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="onDeviceDisconnected"></a>
                    <span class="name">
                        <span ><b>onDeviceDisconnected</b></span>
                        <a href="#onDeviceDisconnected"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>onDeviceDisconnected(peripheral)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="160"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:160</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>peripheral</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="onDeviceDiscovered"></a>
                    <span class="name">
                        <span ><b>onDeviceDiscovered</b></span>
                        <a href="#onDeviceDiscovered"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>onDeviceDiscovered(device)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="62"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:62</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>device</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="parseGatewayMessage"></a>
                    <span class="name">
                        <span ><b>parseGatewayMessage</b></span>
                        <a href="#parseGatewayMessage"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>parseGatewayMessage(buffer: Uint8Array)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="207"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:207</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>buffer</td>
                                    <td>
                                            <code>Uint8Array</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resetConnection"></a>
                    <span class="name">
                        <span ><b>resetConnection</b></span>
                        <a href="#resetConnection"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>resetConnection()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="104"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:104</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resetGateway"></a>
                    <span class="name">
                        <span ><b>resetGateway</b></span>
                        <a href="#resetGateway"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>resetGateway()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="259"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:259</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resetShots"></a>
                    <span class="name">
                        <span ><b>resetShots</b></span>
                        <a href="#resetShots"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>resetShots()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="92"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:92</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="scan"></a>
                    <span class="name">
                        <span ><b>scan</b></span>
                        <a href="#scan"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>scan()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="51"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:51</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="scanError"></a>
                    <span class="name">
                        <span ><b>scanError</b></span>
                        <a href="#scanError"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>scanError(error)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="115"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:115</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>error</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="str2ab"></a>
                    <span class="name">
                        <span ><b>str2ab</b></span>
                        <a href="#str2ab"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>str2ab(str)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="266"
                            class="link-to-prism">src/app/shared/services/ble.service.ts:266</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>str</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="activateReconnectProcessCount"></a>
                    <span class="name">
                        <span ><b>activateReconnectProcessCount</b></span>
                        <a href="#activateReconnectProcessCount"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>0</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/shared/services/ble.service.ts:34</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="ble"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>ble</b></span>
                        <a href="#ble"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>BLE</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="38" class="link-to-prism">src/app/shared/services/ble.service.ts:38</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="currentTargetId"></a>
                    <span class="name">
                        <span ><b>currentTargetId</b></span>
                        <a href="#currentTargetId"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="27" class="link-to-prism">src/app/shared/services/ble.service.ts:27</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="dataFromDevice"></a>
                    <span class="name">
                        <span ><b>dataFromDevice</b></span>
                        <a href="#dataFromDevice"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="21" class="link-to-prism">src/app/shared/services/ble.service.ts:21</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="devices"></a>
                    <span class="name">
                        <span ><b>devices</b></span>
                        <a href="#devices"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>any[]</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="19" class="link-to-prism">src/app/shared/services/ble.service.ts:19</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="gateways"></a>
                    <span class="name">
                        <span ><b>gateways</b></span>
                        <a href="#gateways"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>[]</code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>[]</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="33" class="link-to-prism">src/app/shared/services/ble.service.ts:33</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="gatewayTargets"></a>
                    <span class="name">
                        <span ><b>gatewayTargets</b></span>
                        <a href="#gatewayTargets"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>literal type</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="31" class="link-to-prism">src/app/shared/services/ble.service.ts:31</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isConnectedFlag"></a>
                    <span class="name">
                        <span ><b>isConnectedFlag</b></span>
                        <a href="#isConnectedFlag"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>false</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="28" class="link-to-prism">src/app/shared/services/ble.service.ts:28</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isGateway"></a>
                    <span class="name">
                        <span ><b>isGateway</b></span>
                        <a href="#isGateway"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="30" class="link-to-prism">src/app/shared/services/ble.service.ts:30</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="msgNumber"></a>
                    <span class="name">
                        <span ><b>msgNumber</b></span>
                        <a href="#msgNumber"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>1</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="18" class="link-to-prism">src/app/shared/services/ble.service.ts:18</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="notifyDisconnect"></a>
                    <span class="name">
                        <span ><b>notifyDisconnect</b></span>
                        <a href="#notifyDisconnect"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new BehaviorSubject(null)</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="23" class="link-to-prism">src/app/shared/services/ble.service.ts:23</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="notifyResetGateway"></a>
                    <span class="name">
                        <span ><b>notifyResetGateway</b></span>
                        <a href="#notifyResetGateway"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new BehaviorSubject(false)</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="32" class="link-to-prism">src/app/shared/services/ble.service.ts:32</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="notifyShotArrived"></a>
                    <span class="name">
                        <span ><b>notifyShotArrived</b></span>
                        <a href="#notifyShotArrived"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new BehaviorSubject(0)</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/app/shared/services/ble.service.ts:22</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="notifyTargetConnected"></a>
                    <span class="name">
                        <span ><b>notifyTargetConnected</b></span>
                        <a href="#notifyTargetConnected"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new BehaviorSubject(false)</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">src/app/shared/services/ble.service.ts:24</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="peripheral"></a>
                    <span class="name">
                        <span ><b>peripheral</b></span>
                        <a href="#peripheral"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="20" class="link-to-prism">src/app/shared/services/ble.service.ts:20</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="scanFinished"></a>
                    <span class="name">
                        <span ><b>scanFinished</b></span>
                        <a href="#scanFinished"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new BehaviorSubject&lt;any&gt;(false)</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="26" class="link-to-prism">src/app/shared/services/ble.service.ts:26</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="subscription"></a>
                    <span class="name">
                        <span ><b>subscription</b></span>
                        <a href="#subscription"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Subscription</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="25" class="link-to-prism">src/app/shared/services/ble.service.ts:25</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import {Injectable, NgZone} from &#x27;@angular/core&#x27;;
import {BLE} from &#x27;@ionic-native/ble/ngx&#x27;;
import {BehaviorSubject, Observable, of, Subscription} from &#x27;rxjs&#x27;;
import {BluetoothSerial} from &#x27;@ionic-native/bluetooth-serial/ngx&#x27;;
import {StorageService} from &#x27;./storage.service&#x27;;
import {GatewayService} from &#x27;./gateway.service&#x27;;
import {InitService} from &#x27;./init.service&#x27;;
import {ShootingService} from &#x27;./shooting.service&#x27;;

const SERVICE_2 &#x3D; &#x27;6e400001-b5a3-f393-e0a9-e50e24dcca9e&#x27;;
const SERVICE_2_CHAR &#x3D; &#x27;6e400003-b5a3-f393-e0a9-e50e24dcca9e&#x27;;
const SERVICE_2_CHAR_WRITE &#x3D; &#x27;6e400002-b5a3-f393-e0a9-e50e24dcca9e&#x27;;

@Injectable({
    providedIn: &#x27;root&#x27;
})
export class BleService {
    msgNumber &#x3D; 1;
    devices: any[];
    peripheral: any;
    dataFromDevice;
    notifyShotArrived &#x3D; new BehaviorSubject(0);
    notifyDisconnect &#x3D; new BehaviorSubject(null);
    notifyTargetConnected &#x3D; new BehaviorSubject(false);
    subscription: Subscription;
    scanFinished &#x3D; new BehaviorSubject&lt;any&gt;(false);
    currentTargetId: any;
    isConnectedFlag &#x3D; false;

    isGateway: boolean;
    gatewayTargets: { gateway: any; target: any };
    notifyResetGateway &#x3D; new BehaviorSubject(false);
    gateways &#x3D; [];
    activateReconnectProcessCount &#x3D; 0;

    constructor(
        private storage: StorageService,
        public ble: BLE,
        private ngZone: NgZone,
        private shootingService: ShootingService,
        private initService: InitService,
        private bluetoothSerial: BluetoothSerial,
        private gatewayService: GatewayService) {
        this.devices &#x3D; this.storage.getItem(&#x27;ble&#x27;);
        if (!this.devices) {
            this.devices &#x3D; [];
        }
    }

    // Scan for BLE devices
    scan() {
        this.devices &#x3D; [];  // clear list
        this.storage.setItem(&#x27;ble&#x27;, this.devices);
        this.ble.scan([], 5).subscribe(device &#x3D;&gt; this.onDeviceDiscovered(device), error &#x3D;&gt; this.scanError(error));
        setTimeout(() &#x3D;&gt; {
            this.storage.setItem(&#x27;ble&#x27;, this.devices);
            this.scanFinished.next(true);
        }, 6000);
    }

    // When a BLE device is discovered we filter only the known devices.
    onDeviceDiscovered(device) {
        this.ngZone.run(() &#x3D;&gt; {
            if (device.name) {
                console.log(&#x27;FOUND DEVICE: &#x27; + device.name);
                if (device.name.toLowerCase().includes(&#x27;adl&#x27;) ||
                    device.name.toLowerCase().includes(&#x27;e64&#x27;) ||
                    device.name.toLowerCase().includes(&#x27;e1n&#x27;) ||
                    device.name.toLowerCase().includes(&#x27;e1n&#x27;) ||
                    device.name.toLowerCase().includes(&#x27;eMarn&#x27;) ||
                    device.name.toLowerCase().includes(&#x27;003&#x27;) ||
                    device.name.toLowerCase().includes(&#x27;e16&#x27;) ||
                    device.name.toLowerCase().includes(&#x27;nordic&#x27;)) {
                    if (this.devices.length &#x3D;&#x3D;&#x3D; 0) {
                        this.devices.push(device);
                        this.storage.setItem(&#x27;ble&#x27;, this.devices);
                    } else if (this.devices.find(o &#x3D;&gt; o.id &#x3D;&#x3D;&#x3D; device.id) &#x3D;&#x3D;&#x3D; undefined) {
                        this.devices.push(device);
                        this.storage.setItem(&#x27;ble&#x27;, this.devices);
                    }
                } else if (device.name.toLowerCase().includes(&#x27;egateway&#x27;)) {
                    this.gateways.push(device.id);
                    this.isGateway &#x3D; true;
                    this.initService.isGateway &#x3D; true;
                    this.connect(device.id);
                }
            }
        });
    }

    // If the connection crashes when it reconnects we reset the stats.
    resetShots() {
        this.gatewayService.initStats();
        const txe &#x3D; new TextEncoder();
        if (this.peripheral &amp;&amp; this.peripheral.id) {
            this.ble.write(this.peripheral.id, SERVICE_2, SERVICE_2_CHAR_WRITE, txe.encode(&#x27;CLCO\n&#x27;).buffer).then((prmise) &#x3D;&gt; {
                console.log(&#x27;From Reset: &#x27; + prmise);
            }).catch(err &#x3D;&gt; {
            });
        }
    }

    // NOT ACTIVE. -this was used when we wanted to let the user refresh the connection.
    resetConnection() {
        const txe &#x3D; new TextEncoder();
        if (this.peripheral &amp;&amp; this.peripheral.id) {
            this.ble.write(this.peripheral.id, SERVICE_2, SERVICE_2_CHAR_WRITE, txe.encode(&#x27;RSTC\n&#x27;).buffer).then((prmise) &#x3D;&gt; {
                console.log(&#x27;reset connection completed&#x27;);
            }).catch(err &#x3D;&gt; {
            });
        }
    }

    // If location permission is denied, you&#x27;ll end up here
    scanError(error) {
        console.log(&#x27;Error: &#x27; + error);
    }

    getDevices() {
        return this.devices;
    }

    // Sets the target to listen for message from.
    connect(deviceId) {
        if (this.gateways.indexOf(deviceId) &gt; -1) {
            this.isGateway &#x3D; true;
            this.initService.isGateway &#x3D; true;
        } else {
            this.resetShots();
        }
        this.currentTargetId &#x3D; deviceId;
        this.ble.connect(deviceId).subscribe(
            (peripheral) &#x3D;&gt; {
                this.isConnectedFlag &#x3D; false;
                this.notifyTargetConnected.next(true);
                this.onConnected(peripheral);
            },
            peripheral &#x3D;&gt; {
                console.log(&#x27;DEVICE DISCONNECT IT SELF&#x27;, peripheral);
                this.activatRecconectProcess();
            }, () &#x3D;&gt; {
            }
        );
    }

    //  Notify comps that a connection has been made.
    onConnected(peripheral: any) {
        this.isConnectedFlag &#x3D; false;
        if (!this.isGateway) {
            this.resetShots();
        }
        console.log(&#x27;Connected to &#x27; + peripheral.name + &#x27; &#x27; + peripheral.id);
        this.ngZone.run(() &#x3D;&gt; {
            this.peripheral &#x3D; peripheral;
        });
        this.handleRead(peripheral.name, peripheral.id, SERVICE_2, SERVICE_2_CHAR);
    }

    //  Notify comps that a connection has been lost.
    onDeviceDisconnected(peripheral) {
    }

    ionViewDidLoad() {
        console.log(&#x27;ionViewDidLoad DetailPage&#x27;);
    }

    ionViewWillLeave() {
        console.log(&#x27;ionViewWillLeave disconnecting Bluetooth&#x27;);
        this.ble.disconnect(this.peripheral.id).then(
            () &#x3D;&gt; console.log(&#x27;Disconnected &#x27; + JSON.stringify(this.peripheral)),
            () &#x3D;&gt; console.log(&#x27;ERROR disconnecting &#x27; + JSON.stringify(this.peripheral))
        );
    }


    handleRead(name, id, service, characteristic) {
        console.log(&#x27;SUBSCRIBED TO START NOTIFICATION&#x27;);
        this.subscription &#x3D; this.ble.startNotification(id, service, characteristic).subscribe((data) &#x3D;&gt; {
            console.log(&#x27;RECEIVED A MESSAGE&#x27;);
            const target &#x3D; this.storage.getItem(&#x27;slectedTarget&#x27;);
            const dec &#x3D; new TextDecoder();
            const enc &#x3D; new TextEncoder().encode(data);
            const temp &#x3D; new TextDecoder().decode(enc);
            const buffer &#x3D; new Uint8Array(data[0]);
            if (this.isGateway) {
                this.parseGatewayMessage(buffer);
            } else {
                if (dec.decode(buffer) &#x3D;&#x3D;&#x3D; &#x27;Clear&#x27;) {
                    console.log(&#x27;Target cleared shots&#x27;);
                } else {
                    // @ts-ignore
                    const encoder &#x3D; new TextEncoder();
                    // @ts-ignore
                    const encodedString &#x3D; encoder.encode(buffer);
                    // tslint:disable-next-line:radix
                    const text &#x3D; parseInt(dec.decode(encodedString));
                    this.notifyShotArrived.next(text);
                    this.ngZone.run(() &#x3D;&gt; {
                        console.log(&#x27;Read from: &#x27; + service + &#x27; &#x27; + service + &#x27; has arrived: &#x27; + text);
                    });
                }
            }

        });
    }

    parseGatewayMessage(buffer: Uint8Array) {
        const selectedTarget &#x3D; this.shootingService.chosenTarget;
        const target &#x3D; this.storage.getItem(&#x27;slectedTarget&#x27;);
        const messageFromGatewaty &#x3D; String.fromCharCode.apply(null, buffer);
        console.log(&#x27;MESSAGE ARRIVED: &#x27; + messageFromGatewaty);
        if (messageFromGatewaty.indexOf(&#x27;,B,&#x27;) &gt; -1) {
            this.gatewayService.processData(messageFromGatewaty);
        } else if (selectedTarget &amp;&amp; messageFromGatewaty.indexOf(&#x27;&lt;&#x27;) &gt; -1 &amp;&amp; messageFromGatewaty.indexOf(selectedTarget.name) &gt; -1) {
            this.gatewayService.processData(messageFromGatewaty);
        } else if (messageFromGatewaty.indexOf(&#x27;Connecting&#x27;) &gt; -1) {
            this.gatewayTargets &#x3D; {gateway: this.currentTargetId, target: messageFromGatewaty.split(&#x27; &#x27;)[3]};
            this.notifyTargetConnected.next(true);
        } else if (messageFromGatewaty.indexOf(&#x27;Disconnected&#x27;) &gt; -1) {
            this.activatRecconectProcess();
        }
    }


    isConnected(): Promise&lt;any&gt; {
        return this.ble.isConnected(this.peripheral);
    }

    dissconect() {
        return this.ble.disconnect(this.currentTargetId);
    }

    activatRecconectProcess() {
        this.ble.disconnect(this.currentTargetId).then(() &#x3D;&gt; {
            this.isConnectedFlag &#x3D; false;
            this.notifyDisconnect.next({isManually: false, status: true});
            console.log(&#x27;Called Disconnect&#x27;);
            try {
                this.subscription &#x3D; this.ble.connect(this.currentTargetId).subscribe(
                    (peripheral) &#x3D;&gt; {
                        this.isConnectedFlag &#x3D; false;
                        this.notifyTargetConnected.next(true);
                        this.onConnected(peripheral);
                    },
                    peripheral &#x3D;&gt; {
                        console.log(&#x27;Disconnected&#x27;, &#x27;The peripheral unexpectedly disconnected&#x27;);
                        if (this.activateReconnectProcessCount &lt; 5) {
                            this.activateReconnectProcessCount++;
                            this.activatRecconectProcess();
                        } else {
                            this.activateReconnectProcessCount &#x3D; 0;
                        }
                    });
            } catch (e) {
            }
        });
    }

    resetGateway() {
        this.ble.write(this.currentTargetId, SERVICE_2, SERVICE_2_CHAR_WRITE, this.str2ab(&#x27;R&#x27;)).then((data) &#x3D;&gt; {
            this.notifyResetGateway.next(true);
        });

    }

    str2ab(str) {
        const buf &#x3D; new ArrayBuffer(str.length * 2); // 2 bytes for each char
        const bufView &#x3D; new Uint16Array(buf);
        for (let i &#x3D; 0, strLen &#x3D; str.length; i &lt; strLen; i++) {
            bufView[i] &#x3D; str.charCodeAt(i);
        }
        return buf;
    }
}
</code></pre>
    </div>

</div>












                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'BleService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
